Copied from CPython v3.10.2 and slightly modified.

https://github.com/python/cpython
